nanobind_add_module(_pers_cub_low_dim_ext _pers_cub_low_dim.cc)
nanobind_add_module(_cubical_complex_ext _cubical_complex.cc)
nanobind_add_module(_ripser_ext _ripser.cc)
nanobind_add_module(_rips_complex_ext _rips_complex.cc)
nanobind_add_module(_edge_collapse_ext _edge_collapse.cc)
nanobind_add_module(_simplex_tree_ext _simplex_tree.cc)
nanobind_add_module(_reader_utils_ext _reader_utils.cc)
nanobind_add_module(_subsampling_ext _subsampling.cc)
nanobind_add_module(_witness_complex_ext _witness_complex.cc)
nanobind_add_module(_nerve_gic_ext _nerve_gic.cc)
nanobind_add_module(_bottleneck_ext _bottleneck.cc)
nanobind_add_module(hera hera.cc)

if(TARGET CGAL::CGAL)
    if(TARGET Eigen3::Eigen)
        nanobind_add_module(_delaunay_complex_ext _delaunay_complex.cc)
        target_link_libraries(_delaunay_complex_ext PRIVATE Eigen3::Eigen)
        target_link_libraries(_delaunay_complex_ext PRIVATE CGAL::CGAL)

        nanobind_add_module(_tangential_complex_ext _tangential_complex.cc)
        target_link_libraries(_tangential_complex_ext PRIVATE CGAL::CGAL)
        target_link_libraries(_tangential_complex_ext PRIVATE Eigen3::Eigen)

        nanobind_add_module(_euclidean_witness_complex_ext _euclidean_witness_complex.cc)
        target_link_libraries(_euclidean_witness_complex_ext PRIVATE CGAL::CGAL)
        target_link_libraries(_euclidean_witness_complex_ext PRIVATE Eigen3::Eigen)

        nanobind_add_module(_euclidean_strong_witness_complex_ext _euclidean_strong_witness_complex.cc)
        target_link_libraries(_euclidean_strong_witness_complex_ext PRIVATE CGAL::CGAL)
        target_link_libraries(_euclidean_strong_witness_complex_ext PRIVATE Eigen3::Eigen)

        nanobind_add_module(_strong_witness_complex_ext _strong_witness_complex.cc)
        target_link_libraries(_strong_witness_complex_ext PRIVATE CGAL::CGAL)
        target_link_libraries(_strong_witness_complex_ext PRIVATE Eigen3::Eigen)

        if(TARGET TBB::tbb)
            target_link_libraries(_delaunay_complex_ext PRIVATE TBB::tbb)
            target_link_libraries(_tangential_complex_ext PRIVATE TBB::tbb)
            target_link_libraries(_euclidean_witness_complex_ext PRIVATE TBB::tbb)
            target_link_libraries(_euclidean_strong_witness_complex_ext PRIVATE TBB::tbb)
            target_link_libraries(_strong_witness_complex_ext PRIVATE TBB::tbb)
        endif()
    endif()
endif ()

if(TARGET TBB::tbb)
    target_link_libraries(_pers_cub_low_dim_ext PRIVATE TBB::tbb)
    target_link_libraries(_cubical_complex_ext PRIVATE TBB::tbb)
    target_link_libraries(_edge_collapse_ext PRIVATE TBB::tbb)
    target_link_libraries(_simplex_tree_ext PRIVATE TBB::tbb)
    target_link_libraries(_rips_complex_ext PRIVATE TBB::tbb)
    target_link_libraries(_witness_complex_ext PRIVATE TBB::tbb)
    target_link_libraries(_nerve_gic_ext PRIVATE TBB::tbb)
    target_link_libraries(_bottleneck_ext PRIVATE TBB::tbb)
endif()
